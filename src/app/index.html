<!DOCTYPE HTML>
<html>
<head>
 <meta charset="UTF-8">
 <title>Title</title>
 <script src="vendor/jquery/dist/jquery.js"></script>
 <script src="vendor/underscore/underscore.js"></script>
 <script src="vendor/backbone/backbone.js"></script>
 <script src="vendor/bootstrap/dist/js/bootstrap.js"></script>
 <link rel="stylesheet" href="vendor/bootstrap/dist/css/bootstrap.css">
 <style type="text/css">
 body {
  padding: 50px 100px 50px 50px;
  background-color: black;
 }
 .thumbnail {
   background-color: lightblue;
 	height: 300px;
 }
 </style>
</head>
<body>
<div class="page-header"><h1 class="text-center text-info">Movie list</h1></div>
<div id="movielist">
</div>
<script>

function writeMovieList(movieListJSON) {

    var i=1;
    var strHTML;
    var thumbURI;
    //strHTML = "Total movies:" + movieListJSON.result.limits.total + "<br/>";
    var movieListDetails = movieListJSON.result.movies;
    $.each(movieListDetails, function(idMovie, movieDetails) {
        if (i == 1) {strHTML += '<div class="row">'};
        strHTML += '<div class="col-sm-3 col-md-3">';
        thumbURI = decodeURIComponent(movieDetails.thumbnail.substring(8,movieDetails.thumbnail.length-1));
        if (!(thumbURI.startsWith("http"))) {thumbURI = "http://osmc/vfs/" + thumbURI};
        strHTML += '<div class="thumbnail"><img src="' + thumbURI + '" height="50%" width="50%">';
        strHTML += '<div class="caption"><p class="text-center">' + movieDetails.label + '</p>';
        strHTML += '<p class="text-center"><button type="button" class="btn btn-info">Info</button></p></div></div></div>';
        i++;
        if (i==5) {
          strHTML += '</div>';
          i = 1;
        };
    });

    document.getElementById('movielist').innerHTML = strHTML;

}

/* Code to fecth JSON from server - Disabled for development / testing
//    var serverKodi = "http://gverni3.eu.qualcomm.com:8890/";
    var serverKodi = "http://192.168.0.203/";
    var urlJsonRPC = "jsonrpc?request=";
    var stringJson = ''{"jsonrpc": "2.0", "method": "VideoLibrary.GetMovies", "params": { "filter": {"field": "playcount", "operator": "is", "value": "0"}, "limits": { "start" : 0, "end": 75 }, "properties" : ["art", "rating", "thumbnail", "playcount", "file"], "sort": { "order": "ascending", "method": "label", "ignorearticle": true } }, "id": "libMovies"}';
*/
    var serverKodi = "../../test_files/";
    var urlJsonRPC = "";
    var stringJson = "videolibrary.getmovies_resp.json";
    var urlKodi = serverKodi + urlJsonRPC + stringJson;

    $.getJSON(urlKodi, jQuery.noop)
    .error(function() { alert("Error reading JSON"); })
    .success(function(data) {
       writeMovieList(data);
    });

</script>
</body>
